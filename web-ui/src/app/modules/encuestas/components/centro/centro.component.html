<mat-card class="encuesta mat-elevation-z2">
  <h4 class="card-header text-center py-3">ASIGNACIÓN POR CENTRO DE COSTOS</h4>
  <div class="table-responsive cuadro" style="overflow: auto; height: 70vh; padding-top: 0; padding-bottom: 0;">
    <table mat-table [dataSource]="dataSource" class="design">
      <!-- <ng-container  matColumnDef="grupo">
        <th mat-header-cell *matHeaderCellDef>GRUPO</th>
        <td mat-cell *matCellDef="let centro"></td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container> -->
      <ng-container matColumnDef="codigo">
        <th mat-header-cell *matHeaderCellDef>CÓDIGO</th>
        <td mat-cell *matCellDef="let centro">{{centro.codigo}}</td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container>

      <ng-container matColumnDef="nombre">
        <th mat-header-cell *matHeaderCellDef>CENTRO</th>
        <td mat-cell *matCellDef="let centro">{{centro.nombre}}</td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container>

      <ng-container matColumnDef="nivel">
        <th mat-header-cell *matHeaderCellDef>NIVEL</th>
        <td mat-cell *matCellDef="let centro"> {{centro.nivel}} </td>
        <td mat-footer-cell *matFooterCellDef>TOTAL</td>
      </ng-container>

      <ng-container matColumnDef="porcentaje">
        <th mat-header-cell *matHeaderCellDef>PORCENTAJE</th>
        <td mat-cell *matCellDef="let centro">
          <mat-form-field>
            <input matInput type="number" [(ngModel)]="centro.porcentaje">
            <span matSuffix>%</span>
          </mat-form-field>
        </td>
        <td mat-footer-cell *matFooterCellDef>
          <mat-form-field>
            <input disabled matInput type="number" value="{{ getTotalPorcentaje() }}">
            <span matSuffix>%</span>
          </mat-form-field>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="dcCentro;  sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: dcCentro;"></tr>
      <tr mat-footer-row *matFooterRowDef="dcCentro; sticky:true"></tr>

      <!-- Group header -->
      <ng-container matColumnDef="groupHeader">
        <td colspan="999" mat-cell *matCellDef="let group" style="flex-direction: row;">
          <div>
            <span class="grupo" style="justify-content: flex-start; align-items: flex-start; text-align: left; width: 100%; "
              colspan="50%">
              <mat-icon *ngIf="group.expanded">expand_less</mat-icon>
              <mat-icon *ngIf="!group.expanded">expand_more</mat-icon>
              <strong>{{group[groupByColumns[group.level-1]]}}</strong>
            </span>
          </div>
          <div>
            <span class="grupo" style="justify-content: flex-end; align-items: flex-end; text-align: right; width: 100%; padding-right: 14px"
              colspan="50%">
              <strong>{{ getTotalPorcentajeByGrupo(group.grupo)}}  <span matSuffix>%</span></strong>
            </span>
          </div>
        </td>
      </ng-container>

      <tr mat-row *matRowDef="let row; columns: ['groupHeader']; when: isGroup" (click)="groupHeaderClick(row)"> </tr>

    </table>
  </div>
</mat-card>